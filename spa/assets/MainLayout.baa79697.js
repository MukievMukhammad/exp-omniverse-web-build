import{k as E,c as m,h as p,q as F,b6 as ke,r as B,b7 as qe,l as Q,a as Te,Q as Y,J as T,g as oe,ag as ze,i as ie,e as q,b8 as re,o as Be,aR as De,p as $e,b9 as Me,b1 as Ie,ba as ae,aX as Re,f as Qe,aS as ge,av as Ee,Z as Ve,v as _e,x as Pe,z as ue,A as me,_ as de,B as f,K as O,F as A,G as o,H as Z,a3 as x,an as K,am as le,bb as Ue,al as He,a8 as Ne,U as Le,bc as Fe,ar as We,V as te,C as b,D as n,E as N,O as je,I as y,L as H,ak as $,W as ee,X as R,bd as Oe,aI as be,M as ne,a6 as h,T as Ge,w as V,N as pe,y as Je,ac as fe,R as X}from"./index.2fde324e.js";import{e as Ke,u as Xe,Q as se,W as he,T as Ye,A as Ze,h as _,i as ve,p as Se,r as k,s as g,q as z,t as xe,g as et,j as tt}from"./audioIO.a640172e.js";import{Q as Ae,J as ot,a as at}from"./JitsiContainer.d4a44580.js";var nt=E({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:t}){const l=m(()=>{const a=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(s=>e[s]===!0).map(s=>`q-btn-group--${s}`).join(" ");return`q-btn-group row no-wrap${a.length!==0?" "+a:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>p("div",{class:l.value},F(t.default))}});const it=Object.keys(ke),lt=e=>it.reduce((t,l)=>{const a=e[l];return a!==void 0&&(t[l]=a),t},{});var we=E({name:"QBtnDropdown",props:{...ke,...Ke,modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String},emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(e,{slots:t,emit:l}){const{proxy:a}=oe(),s=B(e.modelValue),u=B(null),c=Xe(),v=m(()=>{const r={"aria-expanded":s.value===!0?"true":"false","aria-haspopup":"true","aria-controls":c,"aria-label":e.toggleAriaLabel||a.$q.lang.label[s.value===!0?"collapse":"expand"](e.label)};return(e.disable===!0||e.split===!1&&e.disableMainBtn===!0||e.disableDropdown===!0)&&(r["aria-disabled"]="true"),r}),M=m(()=>"q-btn-dropdown__arrow"+(s.value===!0&&e.noIconAnimation===!1?" rotate-180":"")+(e.split===!1?" q-btn-dropdown__arrow-container":"")),i=m(()=>qe(e)),S=m(()=>lt(e));Q(()=>e.modelValue,r=>{u.value!==null&&u.value[r?"show":"hide"]()}),Q(()=>e.split,w);function D(r){s.value=!0,l("beforeShow",r)}function W(r){l("show",r),l("update:modelValue",!0)}function L(r){s.value=!1,l("beforeHide",r)}function I(r){l("hide",r),l("update:modelValue",!1)}function j(r){l("click",r)}function G(r){ze(r),w(),l("click",r)}function P(r){u.value!==null&&u.value.toggle(r)}function d(r){u.value!==null&&u.value.show(r)}function w(r){u.value!==null&&u.value.hide(r)}return Object.assign(a,{show:d,hide:w,toggle:P}),Te(()=>{e.modelValue===!0&&d()}),()=>{const r=[p(Y,{class:M.value,name:e.dropdownIcon||a.$q.iconSet.arrow.dropdown})];return e.disableDropdown!==!0&&r.push(p(Ae,{ref:u,id:c,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:D,onShow:W,onBeforeHide:L,onHide:I},t.default)),e.split===!1?p(T,{class:"q-btn-dropdown q-btn-dropdown--simple",...S.value,...v.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:j},{default:()=>F(t.label,[]).concat(r),loading:t.loading}):p(nt,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:e.rounded,square:e.square,...i.value,glossy:e.glossy,stretch:e.stretch},()=>[p(T,{class:"q-btn-dropdown--current",...S.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:G},{default:t.label,loading:t.loading}),p(T,{class:"q-btn-dropdown__arrow-container q-anchor--skip",...v.value,...i.value,disable:e.disable===!0||e.disableDropdown===!0,rounded:e.rounded,color:e.color,textColor:e.textColor,dense:e.dense,size:e.size,padding:e.padding,ripple:e.ripple},()=>r)])}}}),st=E({name:"QToolbarTitle",props:{shrink:Boolean},setup(e,{slots:t}){const l=m(()=>"q-toolbar__title ellipsis"+(e.shrink===!0?" col-shrink":""));return()=>p("div",{class:l.value},F(t.default))}}),rt=E({name:"QToolbar",props:{inset:Boolean},setup(e,{slots:t}){const l=m(()=>"q-toolbar row no-wrap items-center"+(e.inset===!0?" q-toolbar--inset":""));return()=>p("div",{class:l.value,role:"toolbar"},F(t.default))}}),ut=E({name:"QHeader",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,revealOffset:{type:Number,default:250},bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:t,emit:l}){const{proxy:{$q:a}}=oe(),s=ie(re,q);if(s===q)return console.error("QHeader needs to be child of QLayout"),q;const u=B(parseInt(e.heightHint,10)),c=B(!0),v=m(()=>e.reveal===!0||s.view.value.indexOf("H")>-1||a.platform.is.ios&&s.isContainer.value===!0),M=m(()=>{if(e.modelValue!==!0)return 0;if(v.value===!0)return c.value===!0?u.value:0;const d=u.value-s.scroll.value.position;return d>0?d:0}),i=m(()=>e.modelValue!==!0||v.value===!0&&c.value!==!0),S=m(()=>e.modelValue===!0&&i.value===!0&&e.reveal===!0),D=m(()=>"q-header q-layout__section--marginal "+(v.value===!0?"fixed":"absolute")+"-top"+(e.bordered===!0?" q-header--bordered":"")+(i.value===!0?" q-header--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus":"")),W=m(()=>{const d=s.rows.value.top,w={};return d[0]==="l"&&s.left.space===!0&&(w[a.lang.rtl===!0?"right":"left"]=`${s.left.size}px`),d[2]==="r"&&s.right.space===!0&&(w[a.lang.rtl===!0?"left":"right"]=`${s.right.size}px`),w});function L(d,w){s.update("header",d,w)}function I(d,w){d.value!==w&&(d.value=w)}function j({height:d}){I(u,d),L("size",d)}function G(d){S.value===!0&&I(c,!0),l("focusin",d)}Q(()=>e.modelValue,d=>{L("space",d),I(c,!0),s.animate()}),Q(M,d=>{L("offset",d)}),Q(()=>e.reveal,d=>{d===!1&&I(c,e.modelValue)}),Q(c,d=>{s.animate(),l("reveal",d)}),Q(s.scroll,d=>{e.reveal===!0&&I(c,d.direction==="up"||d.position<=e.revealOffset||d.position-d.inflectionPoint<100)});const P={};return s.instances.header=P,e.modelValue===!0&&L("size",u.value),L("space",e.modelValue),L("offset",M.value),Be(()=>{s.instances.header===P&&(s.instances.header=void 0,L("size",0),L("offset",0),L("space",!1))}),()=>{const d=De(t.default,[]);return e.elevated===!0&&d.push(p("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),d.push(p(se,{debounce:0,onResize:j})),p("header",{class:D.value,style:W.value,onFocusin:G},d)}}}),dt=E({name:"QPageContainer",setup(e,{slots:t}){const{proxy:{$q:l}}=oe(),a=ie(re,q);if(a===q)return console.error("QPageContainer needs to be child of QLayout"),q;$e(Me,!0);const s=m(()=>{const u={};return a.header.space===!0&&(u.paddingTop=`${a.header.size}px`),a.right.space===!0&&(u[`padding${l.lang.rtl===!0?"Left":"Right"}`]=`${a.right.size}px`),a.footer.space===!0&&(u.paddingBottom=`${a.footer.size}px`),a.left.space===!0&&(u[`padding${l.lang.rtl===!0?"Right":"Left"}`]=`${a.left.size}px`),u});return()=>p("div",{class:"q-page-container",style:s.value},F(t.default))}}),ct=E({name:"QLayout",props:{container:Boolean,view:{type:String,default:"hhh lpr fff",validator:e=>/^(h|l)h(h|r) lpr (f|l)f(f|r)$/.test(e.toLowerCase())},onScroll:Function,onScrollHeight:Function,onResize:Function},setup(e,{slots:t,emit:l}){const{proxy:{$q:a}}=oe(),s=B(null),u=B(a.screen.height),c=B(e.container===!0?0:a.screen.width),v=B({position:0,direction:"down",inflectionPoint:0}),M=B(0),i=B(Ie.value===!0?0:he()),S=m(()=>"q-layout q-layout--"+(e.container===!0?"containerized":"standard")),D=m(()=>e.container===!1?{minHeight:a.screen.height+"px"}:null),W=m(()=>i.value!==0?{[a.lang.rtl===!0?"left":"right"]:`${i.value}px`}:null),L=m(()=>i.value!==0?{[a.lang.rtl===!0?"right":"left"]:0,[a.lang.rtl===!0?"left":"right"]:`-${i.value}px`,width:`calc(100% + ${i.value}px)`}:null);function I(r){if(e.container===!0||document.qScrollPrevented!==!0){const C={position:r.position.top,direction:r.direction,directionChanged:r.directionChanged,inflectionPoint:r.inflectionPoint.top,delta:r.delta.top};v.value=C,e.onScroll!==void 0&&l("scroll",C)}}function j(r){const{height:C,width:U}=r;let J=!1;u.value!==C&&(J=!0,u.value=C,e.onScrollHeight!==void 0&&l("scrollHeight",C),P()),c.value!==U&&(J=!0,c.value=U),J===!0&&e.onResize!==void 0&&l("resize",r)}function G({height:r}){M.value!==r&&(M.value=r,P())}function P(){if(e.container===!0){const r=u.value>M.value?he():0;i.value!==r&&(i.value=r)}}let d=null;const w={instances:{},view:m(()=>e.view),isContainer:m(()=>e.container),rootRef:s,height:u,containerHeight:M,scrollbarWidth:i,totalWidth:m(()=>c.value+i.value),rows:m(()=>{const r=e.view.toLowerCase().split(" ");return{top:r[0].split(""),middle:r[1].split(""),bottom:r[2].split("")}}),header:ae({size:0,offset:0,space:!1}),right:ae({size:300,offset:0,space:!1}),footer:ae({size:0,offset:0,space:!1}),left:ae({size:300,offset:0,space:!1}),scroll:v,animate(){d!==null?clearTimeout(d):document.body.classList.add("q-body--layout-animate"),d=setTimeout(()=>{d=null,document.body.classList.remove("q-body--layout-animate")},155)},update(r,C,U){w[r][C]=U}};if($e(re,w),he()>0){let U=function(){r=null,C.classList.remove("hide-scrollbar")},J=function(){if(r===null){if(C.scrollHeight>a.screen.height)return;C.classList.add("hide-scrollbar")}else clearTimeout(r);r=setTimeout(U,300)},ce=function(ye){r!==null&&ye==="remove"&&(clearTimeout(r),U()),window[`${ye}EventListener`]("resize",J)},r=null;const C=document.body;Q(()=>e.container!==!0?"add":"remove",ce),e.container!==!0&&ce("add"),Re(()=>{ce("remove")})}return()=>{const r=Qe(t.default,[p(Ye,{onScroll:I}),p(se,{onResize:j})]),C=p("div",{class:S.value,style:D.value,ref:e.container===!0?void 0:s,tabindex:-1},r);return e.container===!0?p("div",{class:"q-layout-container overflow-hidden",ref:s},[p(se,{onResize:G}),p("div",{class:"absolute-full",style:W.value},[p("div",{class:"scroll",style:L.value},[C])])]):C}}});function pt(e){const t=Object.assign({noopener:!0},e),l=[];for(const a in t){const s=t[a];s===!0?l.push(a):(Ve(s)||typeof s=="string"&&s!=="")&&l.push(a+"="+s)}return l.join(",")}function Ce(e,t,l){let a=window.open;if(ge.is.cordova===!0){if(cordova!==void 0&&cordova.InAppBrowser!==void 0&&cordova.InAppBrowser.open!==void 0)a=cordova.InAppBrowser.open;else if(navigator!==void 0&&navigator.app!==void 0)return navigator.app.loadUrl(e,{openExternal:!0})}const s=a(e,"_blank",pt(l));if(s)return ge.is.desktop&&s.focus(),s;t&&t()}var ft=(e,t,l)=>{if(ge.is.ios===!0&&window.SafariViewController!==void 0){window.SafariViewController.isAvailable(a=>{a?window.SafariViewController.show({url:e},Ee,t):Ce(e,t,l)});return}return Ce(e,t,l)},ht=E({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(e,{slots:t}){const{proxy:{$q:l}}=oe(),a=ie(re,q);if(a===q)return console.error("QPage needs to be a deep child of QLayout"),q;if(ie(Me,q)===q)return console.error("QPage needs to be child of QPageContainer"),q;const u=m(()=>{const v=(a.header.space===!0?a.header.size:0)+(a.footer.space===!0?a.footer.size:0);if(typeof e.styleFn=="function"){const M=a.isContainer.value===!0?a.containerHeight.value:l.screen.height;return e.styleFn(v,M)}return{minHeight:a.isContainer.value===!0?a.containerHeight.value-v+"px":l.screen.height===0?v!==0?`calc(100vh - ${v}px)`:"100vh":l.screen.height-v+"px"}}),c=m(()=>`q-page${e.padding===!0?" q-layout-padding":""}`);return()=>p("main",{class:c.value,style:u.value},F(t.default))}});const vt=[p("defs",[p("linearGradient",{x1:"8.042%",y1:"0%",x2:"65.682%",y2:"23.865%",id:"a"},[p("stop",{"stop-color":"currentColor","stop-opacity":"0",offset:"0%"}),p("stop",{"stop-color":"currentColor","stop-opacity":".631",offset:"63.146%"}),p("stop",{"stop-color":"currentColor",offset:"100%"})])]),p("g",{transform:"translate(1 1)",fill:"none","fill-rule":"evenodd"},[p("path",{d:"M36 18c0-9.94-8.06-18-18-18",stroke:"url(#a)","stroke-width":"2"},[p("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"0.9s",repeatCount:"indefinite"})]),p("circle",{fill:"currentColor",cx:"36",cy:"18",r:"1"},[p("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"0.9s",repeatCount:"indefinite"})])])];var gt=E({name:"QSpinnerTail",props:_e,setup(e){const{cSize:t,classes:l}=Pe(e);return()=>p("svg",{class:l.value,width:t.value,height:t.value,viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg"},vt)}});const mt=ue({name:"LoadingScreen",setup(){return{applicationStore:me}}}),yt={class:"inner"},bt=["src"];function St(e,t,l,a,s,u){return f(),O("div",{id:"loadingScreen",onClick:t[0]||(t[0]=Z(()=>{},["stop"]))},[A("div",yt,[A("img",{src:e.applicationStore.theme.logo,draggable:"false",alt:"",width:"200",height:"200"},null,8,bt),o(gt,{size:"xl"})])])}var wt=de(mt,[["render",St],["__scopeId","data-v-44a7f2f6"]]);const Ct=ue({name:"MainScene",props:{interactive:{type:Boolean,required:!0}},components:{LoadingScreen:wt,JitsiContainer:ot},emits:["join-conference-room"],setup(){return{applicationStore:me,userStore:x}},data(){return{sceneCreated:!1,canvasHeight:200,canvasWidth:200,updateUrlReady:!0,locationUnwatch:()=>{},previousLocation:void 0}},watch:{$route:"connect"},methods:{resize(e){this.canvasHeight=e.height,this.canvasWidth=e.width,K.resize()},unload(){le.disconnectActiveDomain(),K.dispose(),this.locationUnwatch()},updateURL(){if(!this.updateUrlReady)return;const e=this.userStore.avatar.location.replace("ws://","").replace("wss://","").replace("http://","").replace("https://","");window.history.replaceState(null,"",`#/${e}`),this.updateUrlReady=!1,setTimeout(()=>{this.updateUrlReady=!0},Ue)},async connect(){var l;let e=Array.isArray(this.$route.params.location)?this.$route.params.location.join("/"):this.$route.params.location;if(e||(e=this.applicationStore.defaultConnectionConfig.DEFAULT_DOMAIN_URL),!e)return;const t=new He(e);await le.connectionSetup(t.host===((l=this.previousLocation)==null?void 0:l.host)?t.pathname:e),this.previousLocation=t,this.locationUnwatch=Q(()=>this.userStore.avatar.location,()=>this.updateURL())}},created(){return this.sceneCreated},beforeMount(){window.addEventListener("beforeunload",()=>this.unload())},mounted(){(async()=>{const t=this.$refs.renderCanvas,a=this.$refs.LoadingScreen.$el;await K.initialize(t,a),this.applicationStore.renderer.focusSceneId=0,Ne.startGameLoop(),await Le.initialize(u=>{const c=this.$refs.mainSceneAudioElement;u?(c.srcObject=u,c.play()):(c.pause(),c.srcObject=null)});const s=K.createScene();s.onEntityEventObservable.add(u=>{u.type===Fe.JOIN_CONFERENCE_ROOM&&this.$emit("join-conference-room",u.data)}),await s.load(void 0,We.getActiveModelData("file")),await this.connect(),K.startRenderLoop([s])})()},beforeUnmount(){window.removeEventListener("beforeunload",()=>this.unload()),this.unload()}}),kt={ref:"mainSceneAudioElement"},$t=["height","width"],Mt={key:0,class:"fpsCounter"},Lt={class:"versionWatermark"};function Ot(e,t,l,a,s,u){const c=te("LoadingScreen"),v=te("JitsiContainer");return f(),b(ht,{class:"full-height"},{default:n(()=>[o(se,{onResize:e.resize},null,8,["onResize"]),A("audio",kt,null,512),A("canvas",{height:e.canvasHeight,width:e.canvasWidth,style:N({position:"relative",zIndex:2,width:e.canvasWidth+"px",height:e.canvasHeight+"px",outline:"none",pointerEvents:e.$props.interactive?"all":"none"}),ref:"renderCanvas",class:"renderCanvas"},null,12,$t),je(e.$slots,"manager",{},void 0,!0),o(c,{ref:"LoadingScreen"},null,512),o(v,{ref:"JitsiContainer"},null,512),e.userStore.graphics.fpsCounter?(f(),O("div",Mt,y(e.applicationStore.renderer.fps.toFixed(0))+" FPS",1)):H("",!0),A("div",Lt,y(e.applicationStore.theme.versionWatermark),1)]),_:3})}var At=de(Ct,[["render",Ot],["__scopeId","data-v-23fd7581"]]);const qt=ue({name:"OverlayManager",data:()=>({overlays:[]}),methods:{getOverlayIndex(e){for(let t=0;t<this.overlays.length;t++)if(this.overlays[t].name===e)return t;return-1},onAction(e,t){let l="",a=t;$.debug($.types.OTHER,`OverlayManager.onAction: ${e}: ${a}`);const s=this.getOverlayIndex(e);switch(a.indexOf(":")>-1&&(l=a.split(":")[1],a=a.split(":")[0]),a){case"select":{const u=this.overlays.splice(s,1)[0];this.overlays.push(u);break}case"minimize":this.overlays[s].overlayStatus==="minimized"?this.overlays[s].overlayStatus="restored":this.overlays[s].overlayStatus="minimized";break;case"maximize":this.overlays[s].overlayStatus==="maximized"?this.overlays[s].overlayStatus="restored":this.overlays[s].overlayStatus="maximized";break;case"close":this.overlays.splice(s,1);break;case"openOverlay":this.openOverlay(l);break;case"toggleOverlay":this.toggleOverlay(l);break;default:window.alert("Action not supported: "+a);break}},openOverlay(e){$.debug($.types.OTHER,`OverlayManager.openOverlay: ${e}`);const t=this.getOverlayIndex(e);if(t>=0){const l=this.overlays.splice(t,1)[0];l.overlayStatus="restored",this.overlays.push(l)}else this.overlays.push({name:e,overlayStatus:"restored"})},toggleOverlay(e){$.debug($.types.OTHER,`OverlayManager.toggleOverlay: ${e}`);const t=this.getOverlayIndex(e);t>=0?this.overlays.splice(t,1):this.overlays.push({name:e,overlayStatus:"restored"})}}});function Tt(e,t,l,a,s,u){return f(!0),O(R,null,ee(e.overlays,c=>(f(),O("div",{key:c.name},[(f(),b(Oe(c.name+"Overlay"),{propsToPass:c,onOverlayAction:v=>e.onAction(c.name,v)},null,40,["propsToPass","onOverlayAction"]))]))),128)}var zt=de(qt,[["render",Tt]]);const Bt=ue({name:"MainLayout",components:{MainScene:At,OverlayManager:zt},setup(){return{applicationStore:me,AudioIO:Ze,userStore:x}},data(){return{mobileBreakpoint:800,isDesktop:!0,isMobile:!1,micMenuState:!1,locationInput:"",settingsMenu:[{icon:"headphones",label:"Audio",link:"",isCategory:!1,separator:!0},{icon:"gamepad",label:"Controls",link:"",isCategory:!1,separator:!0},{icon:"desktop_windows",label:"Graphics",link:"",isCategory:!1,separator:!0},{icon:"badge",label:"Nametags",action:()=>{x.avatar.showNametags=!x.avatar.showNametags,$.info($.types.OTHER,"Toggle Avatar Nametags")},isCategory:!1,separator:!0,caption:"nametag_setting"},{icon:"lightbulb",label:"Light / Dark",action:()=>{this.$q.dark.toggle(),$.info($.types.OTHER,"Toggle Dark")},isCategory:!1,separator:!1}],settingsMenuState:!1,helpMenu:[{icon:"chat",label:"Discord",link:"https://discord.com/invite/Pvx2vke"},{icon:"forum",label:"Forum",link:"https://forum.vircadia.com/"},{icon:"support",label:"User Documentation",link:"https://docs.vircadia.com/"},{icon:"delete_sweep",label:"Clear All Settings",action:()=>{x.reset(),window.location.reload()}},{icon:"download_for_offline",label:"Download Debug Log",action:()=>{const e=document.createElement("a");e.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent($.dump())),e.setAttribute("download","vircadia-log.txt"),e.click()}}],helpMenuState:!1,aMenuIsOpen:!1,lastConnectedDomain:void 0,domainLocationCopied:!1,metaverseLocationCopied:!1}},computed:{location(){return this.userStore.avatar.location??"Not currently connected to a domain."},domainServerState(){return this.applicationStore.domain.connectionState??"DISCONNECTED"},metaverseServerState(){return this.applicationStore.metaverse.connectionState},metaverseServerLocation(){return this.applicationStore.metaverse.server??"Not currently connected to a metaverse server."},profilePicture(){var e;return(e=this.userStore.account.images)==null?void 0:e.thumbnail},headerStyle(){if(this.applicationStore.theme.globalStyle==="none")return"unset";const e={aero:"5c",mica:"30"};if(this.applicationStore.theme.headerStyle==="none")return"unset";const l={"gradient-left":"circle at 0% 50%","gradient-right":"circle at 100% 50%"}[this.applicationStore.theme.headerStyle],a=this.applicationStore.theme.colors.primary,s=this.applicationStore.theme.colors.secondary,u=this.$q.dark.isActive?"#121212":"#ffffff",c=e[this.applicationStore.theme.globalStyle];return`radial-gradient(${l}, ${s}${c} 15%, ${a}${c} 40%, ${u}${c} 95%)`},microphoneColor(){return this.applicationStore.audio.user.hasInputAccess?this.applicationStore.audio.user.muted?"red":"primary":"grey-6"}},methods:{toggleUserMenu(){var e;(e=this.$refs.OverlayManager)==null||e.toggleOverlay("Menu")},hideSettingsAndHelpMenus(){this.aMenuIsOpen&&(this.aMenuIsOpen=!1,this.settingsMenuState=!1,this.helpMenuState=!1)},async connect(){await this.connectToAddress(this.locationInput)},async connectToAddress(e){$.info($.types.UI,`Connecting to... ${e}`),await le.connectionSetup(e)},disconnect(){$.info($.types.UI,`Disconnecting from... ${this.userStore.avatar.location}`),this.lastConnectedDomain=this.userStore.avatar.location,le.disconnectActiveDomain()},logout(){be.logout(),this.$q.notify({type:"positive",textColor:"white",icon:"cloud_done",message:"Logged out."})},openDialog(e,t){this.applicationStore.dialog.show=t,this.applicationStore.dialog.which=e},closeDialog(){this.applicationStore.dialog.show=!1,this.applicationStore.dialog.which=""},onClickOpenOverlay(e){var t;(t=this.$refs.OverlayManager)==null||t.openOverlay(e)},joinConferenceRoom(e){var t;this.applicationStore.joinConferenceRoom(e),(t=this.$refs.OverlayManager)==null||t.toggleOverlay("Jitsi")},openUrl(e){ft(e)},toggleMicrophoneMute(){this.applicationStore.audio.user.hasInputAccess&&Le.muteAudio()},async copyDomainLocationToClipboard(){this.domainLocationCopied=!0,await navigator.clipboard.writeText(this.location);const e=1700;window.setTimeout(()=>{this.domainLocationCopied=!1},e)},async copyMetaverseLocationToClipboard(){this.metaverseLocationCopied=!0,await navigator.clipboard.writeText(this.metaverseServerLocation);const e=1700;window.setTimeout(()=>{this.metaverseLocationCopied=!1},e)},formatMenuItemCaption(e){switch(e){case"nametag_setting":return this.userStore.avatar.showNametags?"On":"Off";default:return e}}},beforeMount(){document.documentElement.style.setProperty("--q-primary",this.applicationStore.theme.colors.primary??null),document.documentElement.style.setProperty("--q-secondary",this.applicationStore.theme.colors.secondary??null),document.documentElement.style.setProperty("--q-accent",this.applicationStore.theme.colors.accent??null)},mounted(){var e,t;this.isMobile=window.innerWidth<this.mobileBreakpoint,this.isDesktop=!this.isMobile,window.addEventListener("resize",()=>{this.isMobile=window.innerWidth<this.mobileBreakpoint,this.isDesktop=!this.isMobile}),be.onAttributeChange.connect(l=>{this.userStore.updateAccountInfo(l)}),this.isDesktop&&((e=this.$refs.OverlayManager)==null||e.openOverlay("Menu"),(t=this.$refs.OverlayManager)==null||t.openOverlay("Chat")),window.addEventListener("keydown",l=>{var s,u,c,v;const a=l.target;(a==null?void 0:a.tagName)!=="INPUT"&&(a==null?void 0:a.tagName)!=="TEXTAREA"&&(l.code===((s=this.userStore.controls.keyboard.other.toggleMenu)==null?void 0:s.keycode)&&((u=this.$refs.OverlayManager)==null||u.toggleOverlay("Menu")),l.code===((c=this.userStore.controls.keyboard.other.openChat)==null?void 0:c.keycode)&&((v=this.$refs.OverlayManager)==null||v.toggleOverlay("Chat")))})}}),Dt={class:"row no-wrap"},It={class:"q-ml-md",style:{display:"flex","flex-direction":"row","justify-content":"flex-start","align-items":"center"}},Rt={class:"q-my-none q-ml-md text-caption"},Qt=["src"],Et={class:"q-ma-none text-no-wrap ellipsis",style:{"max-width":"300px"}},Vt={class:"q-ma-none text-no-wrap ellipsis",style:{"max-width":"300px"}};function _t(e,t,l,a,s,u){const c=te("AudioLevel"),v=te("OverlayManager"),M=te("MainScene");return f(),b(ct,{class:"full-height",id:"mainLayout",view:"lHh Lpr lFf"},{default:n(()=>[o(ut,{id:"header",elevated:"",style:N([{color:"unset","background-color":"unset"},{background:e.headerStyle}])},{default:n(()=>[A("div",Dt,[o(rt,{style:N({padding:e.isMobile?"0px 0px 0px 8px":"0px 12px"})},{default:n(()=>[o(T,{flat:"",round:"",dense:"",icon:"menu","aria-label":"User Menu",onClick:e.toggleUserMenu,class:ne({"q-mr-sm":e.isDesktop,"q-mr-xs":e.isMobile})},null,8,["onClick","class"]),o(_,{dark:"",vertical:"",inset:""}),e.isDesktop?(f(),b(T,{key:0,flat:"",round:"",dense:"",icon:"travel_explore","aria-label":"Explore",onClick:t[0]||(t[0]=i=>e.onClickOpenOverlay("Explore")),class:"q-mr-sm q-ml-sm"})):H("",!0),o(c,{color:e.microphoneColor,compact:e.isMobile},null,8,["color","compact"]),A("div",null,[e.isDesktop?(f(),b(we,{key:0,split:"",flat:"",round:"",dense:"","fab-mini":"",title:e.applicationStore.audio.user.hasInputAccess?e.applicationStore.audio.user.muted?"Unmute microphone":"Mute microphone":void 0,icon:e.applicationStore.audio.user.muted||!e.applicationStore.audio.user.hasInputAccess?"mic_off":"mic",color:e.microphoneColor,class:"q-mr-sm q-ml-sm",style:N({backgroundColor:e.$q.dark.isActive?"#282828":"#e8e8e8"}),"disable-dropdown":!e.applicationStore.audio.user.hasInputAccess,modelValue:e.micMenuState,"onUpdate:modelValue":t[3]||(t[3]=i=>e.micMenuState=i),onClick:e.toggleMicrophoneMute},{default:n(()=>[o(ve,{style:{"max-width":"300px"},onClick:t[2]||(t[2]=Z(()=>{},["stop"]))},{default:n(()=>[(f(!0),O(R,null,ee(e.applicationStore.audio.inputsList,i=>(f(),b(z,{key:i.deviceId},{default:n(()=>[o(tt,{onClick:S=>{e.AudioIO.requestInputAccess(i.deviceId),e.micMenuState=!1},modelValue:e.AudioIO.selectedInput,"onUpdate:modelValue":t[1]||(t[1]=S=>e.AudioIO.selectedInput=S),val:i.label,label:i.label,title:i.label,color:"teal",class:"ellipsis"},null,8,["onClick","modelValue","val","label","title"])]),_:2},1024))),128))]),_:1})]),_:1},8,["title","icon","color","style","disable-dropdown","modelValue","onClick"])):(f(),b(T,{key:1,split:"",flat:"",round:"",dense:"","fab-mini":"",title:e.applicationStore.audio.user.hasInputAccess?e.applicationStore.audio.user.muted?"Unmute microphone":"Mute microphone":void 0,icon:e.applicationStore.audio.user.muted||!e.applicationStore.audio.user.hasInputAccess?"mic_off":"mic",color:e.microphoneColor,onClick:e.toggleMicrophoneMute,class:"q-mr-sm q-ml-sm",style:N({backgroundColor:e.$q.dark.isActive?"#282828":"#e8e8e8"})},null,8,["title","icon","color","onClick","style"])),e.applicationStore.audio.user.hasInputAccess?H("",!0):(f(),b(Se,{key:2,class:"bg-black","transition-show":"jump-down","transition-hide":"jump-up"},{default:n(()=>[h("Please allow microphone access.")]),_:1}))]),o(st,{class:ne(["non-selectable",{"q-px-xs":e.isMobile}])},{default:n(()=>[o(k,null,{default:n(()=>[o(g,{style:N([{display:"flex","flex-direction":"row","justify-content":"flex-start","align-items":"center"},{fontSize:e.isMobile?"0.8em":"inherit"}])},{default:n(()=>[h(y(e.domainServerState)+" ",1),o(Ge,null,{default:n(()=>[V(A("div",It,[o(Je,{size:e.isMobile?"xs":"sm",title:e.applicationStore.renderer.contentIsLoading?"Loading content":void 0},null,8,["size","title"]),A("p",Rt,y(`${e.applicationStore.renderer.contentLoadingSpeed.toFixed(1)}MB/s`),1),o(Se,{class:ne({"bg-black":e.$q.dark.isActive,"text-white":e.$q.dark.isActive}),"hide-delay":300},{default:n(()=>[h(y(e.applicationStore.renderer.contentIsLoading&&e.applicationStore.renderer.contentLoadingInfo?e.applicationStore.renderer.contentLoadingInfo:"Loading..."),1)]),_:1},8,["class"])],512),[[pe,e.domainServerState==="CONNECTING"||e.applicationStore.renderer.contentIsLoading]])]),_:1})]),_:1},8,["style"])]),_:1})]),_:1},8,["class"]),e.isDesktop?(f(),O(R,{key:1},[V((f(),b(z,{clickable:"",class:"non-selectable",onClick:t[4]||(t[4]=i=>e.userStore.account.isLoggedIn?e.onClickOpenOverlay("Account"):e.openDialog("Login",!0))},{default:n(()=>[o(k,{side:""},{default:n(()=>[o(fe,{size:"48px"},{default:n(()=>[o(xe,{src:e.profilePicture},null,8,["src"])]),_:1})]),_:1}),o(k,null,{default:n(()=>[o(g,null,{default:n(()=>[h(y(e.userStore.account.isLoggedIn?e.userStore.account.username:"Guest"),1)]),_:1}),o(g,{caption:""},{default:n(()=>[h(y(e.userStore.account.isLoggedIn?"Logged in":`Click to log in to the ${e.applicationStore.theme.globalServiceTerm.toLowerCase()}.`),1)]),_:1})]),_:1})]),_:1})),[[X]]),V(o(T,{flat:"",round:"",dense:"",icon:"logout","aria-label":"Logout",onClick:e.logout,class:"q-mr-sm q-ml-sm"},null,8,["onClick"]),[[pe,e.userStore.account.isLoggedIn]]),o(_,{dark:"",vertical:""}),o(T,{flat:"",stretch:"",icon:"settings","aria-label":"Settings Menu"},{default:n(()=>[o(Ae,{modelValue:e.settingsMenuState,"onUpdate:modelValue":t[5]||(t[5]=i=>e.settingsMenuState=i),onShow:t[6]||(t[6]=i=>e.aMenuIsOpen=!0)},{default:n(()=>[o(ve,{class:"non-selectable"},{default:n(()=>[(f(!0),O(R,null,ee(e.settingsMenu,(i,S)=>(f(),O(R,{key:S},[i.isCategory?(f(),b(g,{key:0,header:""},{default:n(()=>[h(y(i.label),1)]),_:2},1024)):V((f(),b(z,{key:1,clickable:"",onClick:D=>i.action?i.action():e.onClickOpenOverlay(i.link||i.label)},{default:n(()=>[o(k,{avatar:""},{default:n(()=>[o(Y,{name:i.icon},null,8,["name"])]),_:2},1024),o(k,null,{default:n(()=>[o(g,null,{default:n(()=>[h(y(i.label),1)]),_:2},1024),i.caption?(f(),b(g,{key:0,caption:""},{default:n(()=>[h(y(e.formatMenuItemCaption(i.caption)),1)]),_:2},1024)):H("",!0)]),_:2},1024)]),_:2},1032,["onClick"])),[[X]]),i.separator?(f(),b(_,{key:"sep"+S})):H("",!0)],64))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)):H("",!0),o(_,{dark:"",vertical:"",inset:""}),o(we,{stretch:"",flat:"",dense:e.isMobile,class:ne({"q-ml-xs":e.isMobile}),persistent:!1,modelValue:e.helpMenuState,"onUpdate:modelValue":t[11]||(t[11]=i=>e.helpMenuState=i),onShow:t[12]||(t[12]=i=>e.aMenuIsOpen=!0)},{label:n(()=>[o(fe,{rounded:"",size:e.isDesktop?"48px":"32px"},{default:n(()=>[A("img",{src:e.applicationStore.theme.logo},null,8,Qt)]),_:1},8,["size"])]),default:n(()=>[o(ve,{class:"q-pb-sm"},{default:n(()=>[e.isMobile?(f(),O(R,{key:0},[o(g,{header:""},{default:n(()=>[h("Account")]),_:1}),V((f(),b(z,{clickable:"",onClick:t[7]||(t[7]=i=>e.userStore.account.isLoggedIn?e.onClickOpenOverlay("Account"):e.openDialog("Login",!0))},{default:n(()=>[o(k,{side:""},{default:n(()=>[o(fe,{size:"48px"},{default:n(()=>[o(Y,{name:e.profilePicture,size:"xl"},null,8,["name"])]),_:1})]),_:1}),o(k,null,{default:n(()=>[o(g,null,{default:n(()=>[h(y(e.userStore.account.isLoggedIn?e.userStore.account.username:"Guest"),1)]),_:1}),o(g,{caption:""},{default:n(()=>[h(y(e.userStore.account.isLoggedIn?"Logged in":`Click to log in to the ${e.applicationStore.theme.globalServiceTerm.toLowerCase()}.`),1)]),_:1})]),_:1})]),_:1})),[[X]]),V(o(T,{flat:"",round:"",dense:"",icon:"logout","aria-label":"Logout",onClick:e.logout,class:"q-mr-sm q-ml-sm"},null,8,["onClick"]),[[pe,e.userStore.account.isLoggedIn]]),o(_,{inset:"",spaced:""}),o(g,{header:""},{default:n(()=>[h("Settings")]),_:1}),(f(!0),O(R,null,ee(e.settingsMenu,(i,S)=>(f(),O(R,{key:S},[i.isCategory?(f(),b(g,{key:0,header:""},{default:n(()=>[h(y(i.label),1)]),_:2},1024)):V((f(),b(z,{key:1,clickable:"",onClick:D=>i.action?i.action():e.onClickOpenOverlay(i.link||i.label),onTouchEnd:t[8]||(t[8]=D=>e.helpMenuState=!1)},{default:n(()=>[o(k,{avatar:""},{default:n(()=>[o(Y,{name:i.icon},null,8,["name"])]),_:2},1024),o(k,null,{default:n(()=>[h(y(i.label),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[X]])],64))),128)),o(_,{inset:"",spaced:""})],64)):H("",!0),o(g,{header:"",class:"non-selectable"},{default:n(()=>[h("Help")]),_:1}),(f(!0),O(R,null,ee(e.helpMenu,(i,S)=>V((f(),b(z,{key:S,clickable:"",class:"non-selectable",onClick:D=>i.action?i.action():e.openUrl(i.link)},{default:n(()=>[o(k,{avatar:"",dense:""},{default:n(()=>[o(Y,{name:i.icon},null,8,["name"])]),_:2},1024),o(k,null,{default:n(()=>[h(y(i.label),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[X]])),128)),o(_,{inset:"",spaced:""}),o(g,{header:"",class:"non-selectable"},{default:n(()=>[h("Status")]),_:1}),o(z,{class:"non-selectable"},{default:n(()=>[o(k,null,{default:n(()=>[o(g,null,{default:n(()=>[h("Domain")]),_:1}),o(g,{caption:""},{default:n(()=>[h(y(e.domainServerState),1)]),_:1}),o(g,{caption:"",class:"row",style:{"align-items":"center"},title:e.location},{default:n(()=>[A("p",Et,y(e.location),1),o(T,{flat:"",round:"",dense:"",icon:e.domainLocationCopied?"done":"content_copy",disable:e.domainLocationCopied,class:"q-ml-sm",title:"Copy",onClick:t[9]||(t[9]=Z(i=>e.copyDomainLocationToClipboard(),["stop"]))},null,8,["icon","disable"])]),_:1},8,["title"])]),_:1})]),_:1}),o(z,{class:"non-selectable"},{default:n(()=>[o(k,null,{default:n(()=>[o(g,null,{default:n(()=>[h(y(e.applicationStore.theme.globalServiceTerm),1)]),_:1}),o(g,{caption:""},{default:n(()=>[h(y(e.metaverseServerState.toUpperCase()),1)]),_:1}),o(g,{caption:"",class:"row",style:{"align-items":"center"},title:e.metaverseServerLocation},{default:n(()=>[A("p",Vt,y(e.metaverseServerLocation),1),o(T,{flat:"",round:"",dense:"",icon:e.metaverseLocationCopied?"done":"content_copy",disable:e.metaverseLocationCopied,class:"q-ml-sm",title:"Copy",onClick:t[10]||(t[10]=Z(i=>e.copyMetaverseLocationToClipboard(),["stop"]))},null,8,["icon","disable"])]),_:1},8,["title"])]),_:1})]),_:1}),o(_,{inset:"",spaced:""}),o(g,{header:"",class:"non-selectable"},{default:n(()=>[h("About")]),_:1}),o(z,null,{default:n(()=>[o(k,null,{default:n(()=>[o(g,null,{default:n(()=>[h(y(e.applicationStore.globalConsts.APP_NAME),1)]),_:1}),o(g,{caption:""},{default:n(()=>[h(y(e.applicationStore.globalConsts.APP_VERSION_TAG),1)]),_:1})]),_:1})]),_:1}),o(z,null,{default:n(()=>[o(k,null,{default:n(()=>[o(g,null,{default:n(()=>[h("Vircadia Web SDK")]),_:1}),o(g,{caption:""},{default:n(()=>[h(y(e.applicationStore.globalConsts.SDK_VERSION_TAG),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["dense","class","modelValue"])]),_:1},8,["style"])])]),_:1},8,["style"]),o(dt,{class:"full-height"},{default:n(()=>[o(M,{interactive:!e.aMenuIsOpen,onClick:t[13]||(t[13]=Z(i=>e.hideSettingsAndHelpMenus(),["prevent"])),onJoinConferenceRoom:t[14]||(t[14]=i=>e.joinConferenceRoom(i))},{manager:n(()=>[o(v,{ref:"OverlayManager"},null,512)]),_:1},8,["interactive"])]),_:1}),o(at,{modelValue:e.applicationStore.dialog.show,"onUpdate:modelValue":t[15]||(t[15]=i=>e.applicationStore.dialog.show=i)},{default:n(()=>[o(et,{class:"column no-wrap items-stretch",style:{width:"310px"}},{default:n(()=>[(f(),b(Oe(e.applicationStore.dialog.which+"Dialog"),{onClose:e.closeDialog},null,40,["onClose"]))]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Nt=de(Bt,[["render",_t]]);export{Nt as default};
